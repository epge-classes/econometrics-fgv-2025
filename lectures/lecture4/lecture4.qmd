---
title: "Lecture 4: Lag Operator, Wold Decomposition, and ARMA Models"
author: "Raul Riva"
institute: "FGV EPGE"
date: "some date"
format: 
    beamer:
        aspectratio: 169
        include-in-header: ../beamer_template.tex
        header-includes:
            - \apptocmd{\tightlist}{\setlength{\itemsep}{8pt}}{}{}
        slide-level: 2
        urlcolor: FGVBlue
        linkcolor: slateblue
        fig-align: center
jupyter: python3
highlight-style: github
---

# Intro

- We will start covering a very useful tool for modelling: ARMA models;
- They combine autoregressive (AR) and moving average (MA) components;
- In a certain sense, they are the most fundamental models for **stationary** time series;
- There will be a neat theorem about this: **Wold's decomposition theorem**;

. . .

- But first we need to get acquainted with the **lag operator** $L$;
- Never underestimate this guy!

# The Lag Operator

- An important vector space for us is the space of sequences;
- Remember that time series are sequences of random variables;

. . .

- An _operator_ for us is a mapping from sequences to sequences;
- The **lag operator** $L$ generates a new sequence by lagging the original sequence by one period;
$$
L(y_t) = y_{t-1}
$$

- This is an informal way of saying
$$
\{\cdots, y_{t-1}, y_t, y_{t+1}, \cdots\} \mapsto \{\cdots, y_{t-2}, y_{t-1}, y_t, \cdots\}
$$

## The Lag Operator Algebra
Some useful tricks:

- $L(\alpha y_t) = \alpha y_{t-1} = \alpha L(y_t), \forall \alpha \in \mathbb{R}$
- $L(y_t + z_t) = y_{t-1} + z_{t-1} = L(y_t) + L(z_t)$
- It is a _linear operator_ $\implies$ all the machinery from functional analysis applies!

. . .

The most important property:

- $L^2(y_t) = L(L(y_t)) = L(y_{t-1}) = y_{t-2}$;
- $L^k(y_t) = y_{t-k}$ for any integer $k > 0$;
- $L^0(y_t) = y_t = I(y_t)$, the identity operator;

. . . 

The polynomial operator $\phi(L) = a_0I + a_1L + a_2 L^2 + a_3 L^3 + ... + a_p L^p$ is such that:
$$
\phi(L)y_t = a_0 y_t + a_1 y_{t-1} + a_2 y_{t-2} + ... + a_p y_{t-p}
$$

## Can we invert an operator?

- Question: for a given operator $T$, can we find an operator $S$ such that $ST = I$?
- In other words, if I see $T(y_t)$, can I recover the original sequence $y_t$?

. . .

- As you imagine, this depends on the operator...
- Yes, you can invert the lag operator: $L^{-1}(y_t) = y_{t+1}$;
- But not this one (dumb example): $T(y_t) = 0 \implies$ obviously you cannot invert it;

. . .

It will be very useful to study the invertibility the polynomials $\phi(L)$:

- Let's start with baby steps: assume $\phi(L) = I - a L$ for some $a \neq 0$;
- Challenge: can you invert this operator?

## Can we ever invert $\phi(L)$?

- Inverting this operator means finding another operator $\psi(L)$ such that $\psi(L) \phi(L) = I$;
- Focus on scalar sequences, abuse notation, and write "1" instead of $I$;
- If $L$ were a number (*it is not a number!!!*), we would like to write $\psi(L) = \frac{1}{1 - a L}$;
- If $|aL| < 1$, we would be able to write: $\psi(L) = 1 + aL + a^2 L^2 + a^3 L^3 + ...$
- The problem with this intuition is that $L$ is not a number!
- What does "$|aL| < 1$" even mean???

## Can we ever invert $\phi(L)$?

- Let's explore this intuition a bit more;
- Consider $\psi_n(L) = 1 + aL + a^2L^2+ ... + a_n L^n$. Then:
$$
\psi_n(L) \phi(L) = (1 + aL + a^2L^2+ ... + a_n L^n)(1 - aL) = 1 - a^{n+1} L^{n+1}
$$

Hence, $\psi_n(L) \phi(L) (y_t) = y_t - a^{n+1} L^{n+1}(y_t) = y_t - a^n y_{t-n}$ for any sequence $\{y_t\}_{t \in \mathbb{Z}}$.

. . .

- If $|a| < 1$, then $\lim_{n \to \infty} a^n = 0$ and $a^n y_{t-n}$ is probably very small;
- Even if $y_t$ is stochastic, but stationary, $a^n y_{t-n}$ converges to zero almost surely; 

. . .

- But if $|a| \geq 1$, then $a^n y_{t-n}$ never dies out!
- So, it seems that the invertibility of $\phi(L)$ depends on the value of $a$...


## Theorem 4.40 from [Rynne and Youngson (2000)](https://link.springer.com/book/10.1007/978-1-84800-005-6)

```{=latex}
\begin{theorem}
Let $B$ be a Banach space equipped with a certain norm $\|.\|$. For any operator $A: B\to B$, let $\|A\| \equiv \sup_{||x|| \leq 1}\|Ax\|$. If $T : B \to B$ is a bounded linear operator and 
$\|I - T\| < 1$, then $T$ is invertible with inverse:
\[
T^{-1} = \sum_{k=0}^{\infty} (I - T)^k.
\]
\end{theorem}
```

- The space of paths generated by second-order stationary processes is a Banach space when equipped with the supremum norm $\|.\|_\infty$;
- $\|y\|_\infty = \sup_t \mathbb{E}|y_t|$. Recall that finite variance implies that this is finite;
- The lag operator is linear and bounded:
$$
|L| = \sup_{||y||_{\infty} \leq 1} ||Ly||_{\infty} = \sup_{\{y\}_{t\in \mathbb{Z}}: \sup_t \mathbb{E}|y_t| \leq 1}||Ly||_{\infty} = \sup_{\{y\}_{t\in \mathbb{Z}}: \sup_t \mathbb{E}|y_t| \leq 1}\left(\sup_t \mathbb{E}|y_{t-1}|\right) = 1
$$

## In our example

- $\phi(L) = I - aL$ is linear and bounded (why?);
- $\|I - \phi(L)\| = \|I - I + aL\| = |a|$;
- $\|I - \phi(L)\| \iff |a| < 1$;

. . .

Now we use the theorem to get exactly what intuition that hinted at before:

$$
\psi(L) \equiv \phi^{-1}(L) = \sum_{k=0}^{\infty} (aL)^k = I + aL + a^2 L^2 + a^3 L^3 + ...
$$

. . . 

In terms of notation, everything below is equivalent:

- $\phi(L)^{-1} \equiv \frac{1}{1 - aL} \equiv \frac{1}{\phi(L)}$ 
- Given two polynomials $\phi_1(L)$ and $\phi_2(L)$, the expression $\frac{\phi_1(L)}{\phi_2(L)}$ means *"first, apply the inverse of $\phi_2(L)$, then apply $\phi_1(L)$"*;

##  {.standout}

Questions?

# AR Models (Finally!!!)


##  {.standout}

The End

## References

-   Hannan, E. J. (1970). *Multiple Time Series*. Wiley.
-   Chapter 2 from Hamilton's book for the Lag Operator;
-   MDS sequences are covered in Chapter 7;
-   Chapter 14 from Hansen's book;